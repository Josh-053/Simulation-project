---
title: "PopPK-Based Dosing Optimization for Triazoconazole"
author: "Joshua Ijidakinro, Ali Kazim"
affiliation: "Faculty of Pharmaceutical Science, KU Leuven"
format: pdf
execute:
  echo: true
  warning: false
  message: false
abstract: >
  The characteristic theme of the works of Stone is the bridge between culture and society. ...
---
{{< pagebreak >}}

# Introduction

Brontogen fibropathy (BF) is an inherited disorder that leads to changes in lung tissue and airflow over time. Patients with BF develop infection from Spirgilus viridicaulis, a fungal species that grows in warm and humid regions. This fungus can be treated using the antimycotic drug triazoconazole. This drug is administered to children with BF for off-label use, as it is originally indicated for patients with bronchiectasis.

# Objectives

The purpose of the simulation is to find an optimal exposure-response relationship for children with Brontogen fibropathy. 

# Packages

The script below shows the packages which were loaded during the report generation. The packages used in this report were:

-   `mrgsolve`: For performing simulations using models based on ordinary differential equations (ODEs);

-   `ggplot2`: For creating graphics using data frames;

-   `tidyverse`: For data formatting;

-   `patchwork`: For combining several elements, such as plots, into one element.

```{r packages}
#| echo: true

if (!require("pacman")) {
  install.packages("pacman")
  library(pacman)}

pacman::p_load(mrgsolve,
               ggplot2,
               tidyverse,
               patchwork)
```

{{< pagebreak >}}

# Simulation Code

```{cpp}
$PARAM
TVCL   = 7.95,  // L/h
TVV    = 190 ,  // L 
TVka   = 0.17,  // 1/h

$CMT DEPOT CENT // 1-compartmental model with absorption

$INPUT BW = 38  // kg, covariate which has effect on PK parameters

$MAIN
double BWEffCL = 0.75    ; // BW effect on CL
double BWEffV  = 1       ; // BW effect on V
double BWEffka = -(0.25) ; // BW effect on ka

double CL  = TVCL * pow((BW/70),BWEffCL) * exp(ETA(1)); // power function for scaling
double V   = TVV  * pow((BW/70),BWEffV)               ;
double ka  = TVka * pow((BW/70),BWEffka)              ;

double k10 = CL/V ; 

$OMEGA
0.1415863641 // CV_CL = 39%

$SIGMA
0.0974896213 // EPS(1)
0.0324       // EPS(2)

$ODE
dxdt_DEPOT   = -(ka) * DEPOT                 ;
dxdt_CENT    =  (ka) * DEPOT  - (k10) * CENT ;

$TABLE 
double IPRED = CENT/V                        ; 
double DV    = IPRED * (1+EPS(1)) + EPS(2)   ;
double BWsim = BW                            ;

$CAPTURE
IPRED DV BWsim
```


```{r}
#| echo: false
mod <- mread("project")
```

```{r}
#| echo: false
mod %>%
  ev(amt = 150) %>% 
  mrgsim() %>% 
  plot()
```

```{r}
#| echo: false
mod %>%
  ev(amt = 250) %>% 
  mrgsim() %>% 
  plot()
```


# Results and Discussion

# Conclusion
